<!-- Form submit goal to Yandex Metrica -->
<script type="text/javascript">
function getClosest(el, s) {
    var r = undefined;
    while (el) {
        if (el.matches(s)) {
            r = el;
            break;
        } else if (el.tagName.toLowerCase() == 'body') {
            break;
        }
        el = el.parentElement;
    }
    return r;
}

document.addEventListener('click', function(e) {
    if (e.target.matches('div.t-form__submit > button')) {
        var form = getClosest(e.target, 'form'),
            name = form.querySelector('[name="Name"]').value.trim(),
            email = form.querySelector('[name="Email"]').value.trim(),
            phone = form.querySelector('[name="Phone"]').value.trim();

        var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        var phonePattern = /^\+7 \(\d{3}\) \d{3}-\d{2}-\d{2}$/;

        if (name && emailPattern.test(email) && phonePattern.test(phone)) {
            console.log('Форма заполнена корректно');
            console.log(name, email, phone);
            ym(94182936, 'reachGoal', 'отправка формы');
        }
    }
    // https://moto.heado.ru/ page forms
    if (window.location.href === 'https://moto.heado.ru/') {
        if (e.target.matches('#form775630019 button')) {
            var form = getClosest(e.target, 'form'),
                name = form.querySelector('[name="name"]').value.trim(),
                email = form.querySelector('[name="email"]').value.trim(),
                phone = form.querySelector('[name="Phone"]').value.trim();

            var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

            if (name && emailPattern.test(email)) {
                console.log('Форма СВЯЖИТЕСЬ СО МНОЙ заполнена корректно');
                console.log(name, email, phone);
                ym(98768665, 'reachGoal', 'motivacia');
            }
        }
        if (e.target.matches('#form757170769 button')) {
            var form = getClosest(e.target, 'form'),
                name = form.querySelector('[name="Name"]').value.trim(),
                email = form.querySelector('[name="Email"]').value.trim(),
                phone = form.querySelector('[type="tel"]').value.trim();

            var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            var phonePattern = /^\(\d{3}\) \d{3}-\d{2}-\d{2}$/;

            if (name && emailPattern.test(email) && phonePattern.test(phone)) {
                console.log('Форма заявки заполнена корректно');
                console.log(name, email, phone);
                ym(98768665, 'reachGoal', 'motivacia');
            }
        }
    }
    // https://moto.heado.ru/tracker page form
    if (window.location.href === 'https://moto.heado.ru/tracker') {
        if (e.target.matches('#form815974365 button')) {
            var form = getClosest(e.target, 'form'),
                name = form.querySelector('[name="Name"]').value.trim(),
                email = form.querySelector('[name="Email"]').value.trim(),
                phone = form.querySelector('[type="tel"]').value.trim();

            var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            var phonePattern = /^\(\d{3}\) \d{3}-\d{2}-\d{2}$/;

            if (name && emailPattern.test(email) && phonePattern.test(phone)) {
                console.log('Форма трекера заполнена корректно');
                console.log(name, email, phone);
                ym(98768665,'reachGoal','tracker');
            }
        }
    }
    //https://moto.heado.ru/dashboards page forms
    if (window.location.href === 'https://moto.heado.ru/dashboards') {
        if (e.target.matches('#form980178136 button')) {
            var form = getClosest(e.target, 'form'),
                name = form.querySelector('[name="Name"]').value.trim(),
                email = form.querySelector('[name="Email"]').value.trim(),
                phone = form.querySelector('[type="tel"]').value.trim();

            var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            var phonePattern = /^\(\d{3}\) \d{3}-\d{2}-\d{2}$/;

            if (name && emailPattern.test(email) && phonePattern.test(phone)) {
                console.log('Форма трекера заполнена корректно');
                console.log(name, email, phone);
                ym(98768665,'reachGoal','dashboard')
            }
        }
    }
});
document.addEventListener('click', function(e) {
    const goals = {
        '#rec978823486 a': { log: 'Клик конверсия', goal: 'konversiya' },
        '#rec900151813 a': { log: 'Клик выручка', goal: 'vyruchka' },
        '#rec978809901 a': { log: 'Клик средний чек', goal: 'srednyi check' },
        '#rec978849616 a': { log: 'Клик количество товаров в чеке', goal: 'tovary' },
        '#rec978766871 a': { log: 'Клик Количество продаж/чеков', goal: 'kolichestvo checkov' },
        '#rec978882681 a': { log: 'Клик Допродажи высокомаржинальных товаров', goal: 'VMT' },
    };

    for (let selector in goals) {
        if (e.target.matches(selector)) {
            console.log(goals[selector].log);
            ym(98768665, 'reachGoal', goals[selector].goal);
            break;
        }
    }
});


</script>
<!-- Form submit goal to Yandex Metrica -->